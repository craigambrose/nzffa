%h1 New Zealand Farm Forestry Association (INC)

.section
  %table{:style => 'width: 100%'}
    %tr
      %td{:style => 'width: 70%'}
      %td
        %h4
          National Office
        %br
        PO Box 10349
        %br
        The Terrace
        %br
        Wellington 6143
        %br
        New Zealand
      %td
        &nbsp;
        %br
        Tel +64 4 472 0432
        %br
        Fax +64 4 472 0432
        %br
        nzffa@clear.net.nz
        %br
        www.nzffa.org.nz

.section
  %h1 &nbsp;
  %div{:style => 'border: 1px solid #000; padding: 10px'}
    =@reader.name
    (#{@reader.nzffa_membership_id})
    %br
    =simple_format @reader.postal_address.to_a.join("\n")

    Telephone
    =@reader.phone
    %br
    Email
    =@reader.email


.section
  %h3 Subscription Renewal / Tax Invoice
  %h3 #{@subscription.begins_on.strftime('%B')} - #{@subscription.expires_on.strftime('%B %Y')}
  %table{:style => 'width: 100%'}
    %tr
      %td{:style => 'width: 70%'}
      %td{:style => 'width: 15%'}
        Rate
      %td{:style => 'width: 15%'}
        Total
    %tr
      %td
        %table.current_subscription
          %tr
            %td Main Branch and Forest Area
            %td
              =@subscription.main_branch_name

              =@subscription.ha_of_planted_trees
              ha
          %tr
            %td Associate Branches
            %td=@subscription.associated_branch_names.join(', ')
          %tr
            %td Action Groups
            %td=@subscription.action_group_names.join(', ')
      %td
        %table
          %tr
            %td
              -total = 0
              $
              =price = NzffaSettings.forest_size_levys[@subscription.ha_of_planted_trees]
              -total += price
          %tr
            %td
              $
              =price = @subscription.associated_branches.map(&:annual_levy).sum
              -total += price
          %tr
            %td
              $
              =price = @subscription.action_groups.map(&:annual_levy).sum
              -total += price
      %td
      %td
      %td
    %tr
      %td
        &nbsp;
      %td
      %td
    %tr
      %td
        %h4 Subtotal
      %td
        $
        =total
      %td
    %tr
      %td
        %p
          Please amend anything that has changed and write the total in the total column.
          %br
          Other forest size options:
          -keys = NzffaSettings.forest_size_levys.keys - [@subscription.ha_of_planted_trees]
          =keys.sort.map{ |size| "#{size} ha ($#{NzffaSettings.forest_size_levys[size]})" }.join(' and ')
      %td
      %td

:css
  .section {
    padding: 5px;
    margin: 5px;
  }

.section
  %h3 Additional Options
  %h4 Associate Branches
  %table
    -branches = Branch.find(:all, :order => 'name') - @subscription.branches
    -branches.in_groups_of(2) do |group|
      %tr
        -group.compact.each do |b|
          %td=check_box_tag b.id
          %td #{b.name} ($#{b.annual_levy.to_i})

.section
  %h4 Special Interest Groups
  %table
    -action_groups = ActionGroup.find(:all, :order => 'name') - @subscription.action_groups
    -action_groups.in_groups_of(2) do |group|
      %tr
        -group.compact.each do |b|
          %td=check_box_tag b.id
          %td #{b.name} ($#{b.annual_levy.to_i})

.section
  %h4 Voluntary Research Contribution (Suggested - $10)
  =check_box_tag :box 
  Tick if yout want your Research Contribtion treated as a donation 
  (previously #{@subscription.research_fund_contribution_is_donation ? 'ticked' : 'not ticked'})

.section
  %h4 Other Products
  %table{:width => '70%'}
    %tr
      %td Name
      %td Price (each)
      %td Quantity
    %tr
      %td Wardle's Native NZ Trees and their story
      %td $95
      %td
    %tr
      %td Neil Barr Book - Eucalypt Trees for Milling
      %td $15
      %td
    %tr
      %td NZFFA Gate Sign, Jersey Badge and Lapel Pin Pack
      %td $15
      %td
    %tr
      %td NZFFA Insignia Cap
      %td $30
      %td

.section
  %table{:style => 'width: 100%'}
    %tr
      %td{:style => 'width: 70%'}
      %td{:style => 'width: 15%'}
        GST Inclusive Total
      %td{:style => 'width: 15%'}
        $


:css
  .payment-options {
    width: 100%;
  }
  .payment-box {
    line-height: 3em;
    border: 1px solid #000
  }
  .payment {
    width: 100%;
  }
  .creditcard {
    width: 70%;
    height: 2em;
  }
  .bx {
    border: 1px solid #000
  }

%br
.payment-box.section
  Want to pay online? Visit www.nzffa.org.nz
  %br
  Other payment methods:
  %br
  %table.payment
    %tr
      %td{:colspan => 4}
    %tr
      %td
        =check_box_tag :direct_debit
        Direct Debit
      %td
        =check_box_tag :cheque
        Cheque
      %td
        =check_box_tag :visa
        Visa
      %td
        =check_box_tag :master_card
        Mastercard
      %td Sorry, American Express not accepted

  %table.payment
    %tr
      %td{:colspan => 4}
        %table.creditcard
          %tr
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
            %td.bx &nbsp;
    %tr
      %td Expiry
      %td
      %td Amount
      %td
    %tr
      %td Cardholder Name
      %td
      %td Cardholder Signature
      %td
    %tr
      %td NZFFA Member #
      %td
      %td Invoice #
      %td

