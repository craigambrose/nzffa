%script{:type => 'text/javascript', :src => '/jquery-1.6.2.min.js'}
%script{:type => 'text/javascript', :src => '/select2.min.js'}

%h1 Edit Advert
-form_for [:admin, @advert], :html => {:multipart => true} do |f|
  =f.error_messages
  %br
  =f.label 'Company Listing'
  =f.check_box :is_company_listing
  %br
  =f.label :categories
  =select_tag 'advert[categories]', options_for_select(Advert::CATEGORIES, f.object.categories), :multiple => true
  %br
  =f.label 'Expires on'
  =f.text_field :expires_on, :class => 'ui-datepicker'
  %br
  =f.label :title
  =f.text_field :title
  %br
  =f.label :body
  =f.text_area :body
  %br
  =f.label :image
  =f.file_field :image
  -f.fields_for :reader do |rf|
    %p
      =rf.label :company_name
      %br
      =rf.text_field :organisation
    =f.label :Region
    %br
    =select_tag 'advert[reader_attributes][region]', options_for_select(['Please Select', Advert::REGIONS].flatten, rf.object.region)
    %p
      =rf.label :contact_person
      %br
      =rf.text_field :contact_person
    %p
      =label_tag 'Phone'
      %br
      =rf.text_field :phone
    %p
      =rf.label :fax
      %br
      =rf.text_field :fax
    %p
      =rf.label :mobile
      %br
      =rf.text_field :mobile
    %p
      =rf.label :email
      %br
      =rf.text_field :email
    %p
      =label_tag 'Postal Address'
      %br
      =rf.text_field :post_line1
      %br
      =rf.text_field :post_line2
      %br
      =rf.text_field :post_city
      %br
      =rf.text_field :post_country
      %br
      Postcode:
      =rf.text_field :postcode
    %p
      =label_tag 'Physical Address'
      %br
      =rf.text_area :physical_address

    %p
      =rf.label :website
      %br
      =rf.text_field :website

  %p
    =f.label :business_description
    %br
    =f.text_area :business_description

  %p
    =f.label :timber_species
    %br
    =f.hidden_field :timber_species, :style => 'width: 300px'

  %p
    =f.label :timber_for_sale
    %br
    =select_tag 'advert[timber_for_sale_terms]', options_for_select(Advert.timber_for_sale_options.map{|o| [o,o] }, f.object.timber_for_sale_terms), :multiple => true, :style => 'width: 300px'

  %p
    =f.label :buyer_of
    %br
    =f.hidden_field :buyer_of,  :style => 'width: 300px'

  %p
    =f.label :supplier_of
    %br
    =f.hidden_field :supplier_of,  :style => 'width: 300px'

  %p
    =f.label :services
    %br
    =f.hidden_field :services, :style => 'width: 300px'

  %p
    =f.submit

:javascript
  $('#advert_timber_species').select2({tags: #{Advert.timber_species_options.to_json}});
  $('#advert_timber_for_sale_terms').select2();
  $('#advert_buyer_of').select2({tags: #{Advert.buyer_of_options.to_json}});
  $('#advert_supplier_of').select2({tags: #{Advert.supplier_of_options.to_json}});
  $('#advert_services').select2({tags: #{Advert.services_options.to_json}});
